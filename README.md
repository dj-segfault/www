# DJ Segfault

Dark cyberpunk Hugo site for DJ Segfault — infinite mix sets generated by code, tweaked by AI.

## Local Development

```bash
# Start dev server with drafts
hugo server -D

# Production build
hugo
```

Requires [Hugo](https://gohugo.io/installation/) (extended edition).

## Project Structure

```
content/           # Markdown content
  mixes/           # Mix entries
  blog/            # Blog posts
  about.md         # About page
themes/segfault/   # Custom theme
  layouts/         # HTML templates
  static/css/      # Stylesheets
hugo.toml          # Site configuration
```

## Adding Content

```bash
# New blog post
hugo new content blog/my-post.md

# New mix
hugo new content mixes/my-mix.md
```

Mix front matter supports: `title`, `date`, `description`, `genre`, `duration`, `bpm`.

## Deployment

Pushes to `main` trigger the GitHub Actions workflow (`.github/workflows/hugo.yml`) which builds and deploys to GitHub Pages.

## Custom Domain with Cloudflare DNS

### 1. Configure GitHub Pages

1. Go to your repo **Settings > Pages**
2. Under **Custom domain**, enter your domain (e.g. `djsegfault.com`)
3. Check **Enforce HTTPS**
4. GitHub will create a `CNAME` file in your repo

### 2. Configure Cloudflare DNS

In your Cloudflare dashboard for the domain, add these DNS records:

**For apex domain (`djsegfault.com`):**

| Type  | Name | Content              | Proxy |
|-------|------|----------------------|-------|
| A     | @    | 185.199.108.153      | DNS only (grey cloud) |
| A     | @    | 185.199.109.153      | DNS only (grey cloud) |
| A     | @    | 185.199.110.153      | DNS only (grey cloud) |
| A     | @    | 185.199.111.153      | DNS only (grey cloud) |

**For `www` subdomain:**

| Type  | Name | Content              | Proxy |
|-------|------|----------------------|-------|
| CNAME | www  | djsegfault.github.io | DNS only (grey cloud) |

### 3. Cloudflare SSL/TLS Settings

- Set SSL/TLS encryption mode to **Full** (not Full Strict)
- Or use **DNS only** (grey cloud icon) on all GitHub Pages records to let GitHub handle SSL directly — this is the simplest setup and avoids redirect loops

### 4. Update Hugo Config

Update `baseURL` in `hugo.toml` to match your custom domain:

```toml
baseURL = 'https://djsegfault.com/'
```

### Troubleshooting

- **Redirect loops**: Usually caused by Cloudflare proxy (orange cloud) + SSL mode mismatch. Switch records to DNS only (grey cloud) or set SSL to Full.
- **Certificate errors**: After adding the custom domain in GitHub, it can take up to 24 hours for the SSL certificate to provision. Check status in Settings > Pages.
- **DNS propagation**: Changes can take a few minutes to a few hours. Verify with `dig djsegfault.com` or `nslookup djsegfault.com`.
